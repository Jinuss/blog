(window.webpackJsonp=window.webpackJsonp||[]).push([[237],{667:function(t,s,a){"use strict";a.r(s);var n=a(4),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),s("p",[t._v("Leaflet中的"),s("code",[t._v("SVGOverlay")]),t._v("是"),s("code",[t._v("ImageOverlay")]),t._v("的扩展类，专门用于在指定地理范围内叠加"),s("strong",[t._v("SVG矢量图像")]),t._v("。与"),s("code",[t._v("ImageOverlay")]),t._v("处理光栅图像不同，它直接操作 SVG DOM元素，支持动态修改矢量内容。")]),t._v(" "),s("h2",{attrs:{id:"源码分析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#源码分析"}},[t._v("#")]),t._v(" 源码分析")]),t._v(" "),s("h3",{attrs:{id:"源码实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#源码实现"}},[t._v("#")]),t._v(" 源码实现")]),t._v(" "),s("p",[s("code",[t._v("SVGOverlay")]),t._v("的源码实现如下：")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" SVGOverlay "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ImageOverlay"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("extend")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("_initImage")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" el "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_image "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_url"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 直接使用传入的 SVG 元素")]),t._v("\n\n    DomUtil"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addClass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"leaflet-image-layer"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_zoomAnimated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      DomUtil"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addClass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"leaflet-zoom-animated"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("className"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      DomUtil"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addClass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("className"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    el"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onselectstart "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Util"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("falseFn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 禁用文本选择")]),t._v("\n    el"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onmousemove "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Util"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("falseFn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 禁用默认拖拽")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("svgOverlay")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("el"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bounds"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SVGOverlay")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bounds"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br")])]),s("h3",{attrs:{id:"源码详解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#源码详解"}},[t._v("#")]),t._v(" 源码详解")]),t._v(" "),s("h4",{attrs:{id:"_1-继承与核心差异"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-继承与核心差异"}},[t._v("#")]),t._v(" 1.继承与核心差异")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("继承自"),s("code",[t._v("ImageOverlay")])]),t._v(":保留了地理范围设置、透明度控制、事件处理等基础功能")]),t._v(" "),s("li",[s("strong",[t._v("关键差异")]),t._v("：\n"),s("ul",[s("li",[s("strong",[t._v("接受SVG元素")]),t._v("而非图片URL")]),t._v(" "),s("li",[s("strong",[t._v("直接操作SVG DOM")]),t._v("，允许实时修改矢量图形")]),t._v(" "),s("li",[s("strong",[t._v("依赖SVG 的"),s("code",[t._v("viewBox")]),t._v("属性")]),t._v("实现自动缩放适配")])])])]),t._v(" "),s("h4",{attrs:{id:"_2-核心方法解析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-核心方法解析"}},[t._v("#")]),t._v(" 2.核心方法解析")]),t._v(" "),s("p",[s("strong",[t._v("1.重写"),s("code",[t._v("_initImage")])])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("直接使用SVG元素")])]),t._v(" "),s("ul",[s("li",[t._v("参数"),s("code",[t._v("url")]),t._v("实际接受已存在的"),s("code",[t._v("SVGElement")]),t._v("或SVG字符串（需解析为元素）")]),t._v(" "),s("li",[t._v("无需创建"),s("code",[t._v("<img>")]),t._v("标签，直接操作SVg节点")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("保留CSS类支持")]),t._v("：允许通过"),s("code",[t._v("className")]),t._v("选项添加自定义样式")])])]),t._v(" "),s("h4",{attrs:{id:"_3-工厂函数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-工厂函数"}},[t._v("#")]),t._v(" 3.工厂函数")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("参数说明")]),t._v("：\n"),s("ul",[s("li",[s("code",[t._v("el")]),t._v(":可以是"),s("code",[t._v("SVGElement")]),t._v("或SVG字符串（需提前解析）")]),t._v(" "),s("li",[s("code",[t._v("bounds")]),t._v("：地理范围("),s("code",[t._v("LatLngBounds")]),t._v(")")]),t._v(" "),s("li",[s("code",[t._v("options")]),t._v("：同"),s("code",[t._v("ImageOverlay")]),t._v("基类的选项，如"),s("code",[t._v("opacity")]),t._v(","),s("code",[t._v("zIndex")]),t._v("等")])])])]),t._v(" "),s("h4",{attrs:{id:"_4-关键特性与使用约束"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-关键特性与使用约束"}},[t._v("#")]),t._v(" 4.关键特性与使用约束")]),t._v(" "),s("p",[s("strong",[t._v("1.SVG的"),s("code",[t._v("viewBox")]),t._v("要求")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("必须设置"),s("code",[t._v("viewBox")])]),t._v(" "),s("ul",[s("li",[t._v("Leaflet依赖"),s("code",[t._v("viewBox")]),t._v("将SVG内部坐标系与地理范围自动匹配")]),t._v(" "),s("li",[t._v("未设置"),s("code",[t._v("viewBox")]),t._v("会导致缩放时图形错位")])])])]),t._v(" "),s("p",[s("strong",[t._v("2.动态修改SVG内容")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("实时交互")]),t._v("：可动态修改SVG子元素的属性、样式或结构")])]),t._v(" "),s("p",[s("strong",[t._v("3.事件冒泡与穿透")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("支持SVG内部元素事件")]),t._v(" "),s("ul",[s("li",[t._v("点击SVG内的子元素会冒泡到"),s("code",[t._v("SVGOverlay")]),t._v("层级")])])])]),t._v(" "),s("h4",{attrs:{id:"_5-与imageoverlay的对比"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-与imageoverlay的对比"}},[t._v("#")]),t._v(" 5. 与"),s("code",[t._v("ImageOverlay")]),t._v("的对比")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("特性")]),t._v(" "),s("th",[s("code",[t._v("ImageOverlay")])]),t._v(" "),s("th",[s("code",[t._v("SVGOverlay")])])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("内容类型")]),t._v(" "),s("td",[t._v("光栅图像(PNG/JPG)")]),t._v(" "),s("td",[t._v("矢量图形（SVG）")])]),t._v(" "),s("tr",[s("td",[t._v("DOM元素")]),t._v(" "),s("td",[s("code",[t._v("<img>")]),t._v("标签")]),t._v(" "),s("td",[s("code",[t._v("<svg>")]),t._v("元素")])]),t._v(" "),s("tr",[s("td",[t._v("动态修改")]),t._v(" "),s("td",[t._v("仅能替换整个图像")]),t._v(" "),s("td",[t._v("可实时修改内部路径、样式、结构")])]),t._v(" "),s("tr",[s("td",[t._v("缩放依赖")]),t._v(" "),s("td",[t._v("自动拉伸像素图像")]),t._v(" "),s("td",[t._v("依赖"),s("code",[t._v("viewBox")]),t._v("的坐标系转换")])]),t._v(" "),s("tr",[s("td",[t._v("分辨率适应性")]),t._v(" "),s("td",[t._v("可能失真")]),t._v(" "),s("td",[t._v("无限缩放不失真")])]),t._v(" "),s("tr",[s("td",[t._v("交互粒度")]),t._v(" "),s("td",[t._v("整个图像")]),t._v(" "),s("td",[t._v("可细化到具体的某一个子元素，如"),s("code",[t._v("<path>")]),t._v("、"),s("code",[t._v("<circle>")])])])])]),t._v(" "),s("h4",{attrs:{id:"性能与最佳实践"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#性能与最佳实践"}},[t._v("#")]),t._v(" 性能与最佳实践")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("复用SVG元素")]),t._v("：避免频繁创建/销毁SVg节点，优先修改现有元素")]),t._v(" "),s("li",[s("strong",[t._v("简化复杂图形")]),t._v("：过多路径节点会影响渲染性能，尤其在移动端")]),t._v(" "),s("li",[s("strong",[t._v("CSS动画优化")]),t._v("：使用"),s("code",[t._v("transform")]),t._v("而非直接修改位置属性以实现流畅动画")])]),t._v(" "),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),s("p",[s("code",[t._v("SVGOverlay")]),t._v(" 是 Leaflet 中处理 "),s("strong",[t._v("​动态矢量图形叠加")]),t._v("​​ 的理想选择，尤其适用于需要实时交互、高分辨率缩放或复杂数据可视化的场景。通过直接操作 SVG DOM，开发者可以灵活控制图形细节，弥补了光栅图像在灵活性和清晰度上的不足")])])}),[],!1,null,null,null);s.default=e.exports}}]);