(window.webpackJsonp=window.webpackJsonp||[]).push([[199],{633:function(t,s,n){"use strict";n.r(s);var a=n(4),e=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h3",{attrs:{id:"概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),s("p",[t._v("生命周期在"),s("code",[t._v("Vue3")]),t._v("中是一个很重要的概念，它允许我们在特定的时间点执行一些代码，比如在组件创建、更新和销毁时执行一些操作。")]),t._v(" "),s("p",[t._v("生命周期函数分为以下几种：")]),t._v(" "),s("ul",[s("li",[t._v("1."),s("code",[t._v("onBeforeMount")]),t._v(": 在组件挂载之前执行")]),t._v(" "),s("li",[t._v("2."),s("code",[t._v("onMounted")]),t._v(": 在组件挂载之后执行")]),t._v(" "),s("li",[t._v("3."),s("code",[t._v("onBeforeUpdate")]),t._v(": 在组件更新之前执行")]),t._v(" "),s("li",[t._v("4."),s("code",[t._v("onUpdated")]),t._v(": 在组件更新之后执行")]),t._v(" "),s("li",[t._v("5."),s("code",[t._v("onBeforeUnmount")]),t._v(": 在组件销毁之前执行")]),t._v(" "),s("li",[t._v("6."),s("code",[t._v("onUnmounted")]),t._v(": 在组件销毁之后执行")]),t._v(" "),s("li",[t._v("7."),s("code",[t._v("onServerPrefetch")]),t._v(": 在服务器端渲染时执行")]),t._v(" "),s("li",[t._v("8."),s("code",[t._v("onRenderTracked")]),t._v(": 在组件渲染时执行")]),t._v(" "),s("li",[t._v("9."),s("code",[t._v("onRenderTriggered")]),t._v(": 在组件渲染时执行")]),t._v(" "),s("li",[t._v("10."),s("code",[t._v("onErrorCaptured")]),t._v(": 在组件发生错误时执行")])]),t._v(" "),s("h4",{attrs:{id:"源码分析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#源码分析"}},[t._v("#")]),t._v(" 源码分析")]),t._v(" "),s("p",[s("code",[t._v("Vue3")]),t._v("中的上述这些生命周期钩子函数的实现大同小异，主要都是基于"),s("code",[t._v("hook")]),t._v("函数实现，位于"),s("code",[t._v("packages\\runtime-core\\dist\\runtime-core.cjs.js")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("createHook")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("lifecycle")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" target "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" currentInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("isInSSRComponentSetup "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" lifecycle "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sp"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("injectHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lifecycle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("args")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("p",[s("code",[t._v("lifecycle")]),t._v("为"),s("code",[t._v("onBeforeMount")]),t._v("等钩子函数名称,如下枚举：,"),s("code",[t._v("hook")]),t._v("就是钩子函数中的回调函数,"),s("code",[t._v("target")]),t._v("为当前组件实例")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("enum")]),t._v(" LifecycleHooks "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("BEFORE_CREATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bc'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CREATED")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'c'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("BEFORE_MOUNT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bm'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MOUNTED")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'m'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("BEFORE_UPDATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bu'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("UPDATED")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'u'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("BEFORE_UNMOUNT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bum'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("UNMOUNTED")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'um'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DEACTIVATED")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'da'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ACTIVATED")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RENDER_TRIGGERED")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'rtg'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RENDER_TRACKED")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'rtc'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ERROR_CAPTURED")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ec'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SERVER_PREFETCH")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sp'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br")])]),s("p",[t._v("在调用"),s("code",[t._v("injectHook")]),t._v("时，会将同类型的"),s("code",[t._v("hook")]),t._v("挂载到组件实例中，"),s("code",[t._v("hook")]),t._v("会被包装一层，用于处理错误捕获和跟踪，其中也用了缓存的策略，具体实现如下：")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("injectHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" target "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" currentInstance"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prepend "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hooks "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" wrappedHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n      hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__weh "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("__weh")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("args")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isUnmounted"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        reactivity"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pauseTracking")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 暂停依赖追踪")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" reset "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setCurrentInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("callWithAsyncErrorHandling")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reset")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        reactivity"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resetTracking")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 恢复依赖追踪")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("prepend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果是前置钩子，则插入到数组的开头")]),t._v("\n      hooks"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("unshift")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wrappedHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      hooks"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wrappedHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" wrappedHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br")])]),s("h5",{attrs:{id:"注册过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注册过程"}},[t._v("#")]),t._v(" 注册过程")]),t._v(" "),s("p",[t._v("上面阐述了"),s("code",[t._v("hook")]),t._v("的创建，接下来看下生命周期钩子函数的注册,函数注册后，才方便"),s("code",[t._v("vue3")]),t._v("在适当的时机调用。"),s("code",[t._v("vue3")]),t._v("自定义了一个"),s("code",[t._v("registerLifecycleHook")]),t._v("函数，用于注册生命周期钩子函数。如下所示：")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerLifecycleHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("register"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" hook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isArray")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("_hook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("register")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_hook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("bind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("publicThis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("register")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("bind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("publicThis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerLifecycleHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("onBeforeMount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" beforeMount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerLifecycleHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("onMounted"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mounted"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerLifecycleHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("onBeforeUpdate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" beforeUpdate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerLifecycleHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("onUpdated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" updated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerLifecycleHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("onActivated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" activated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerLifecycleHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("onDeactivated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" deactivated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerLifecycleHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("onErrorCaptured"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" errorCaptured"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerLifecycleHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("onRenderTracked"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" renderTracked"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerLifecycleHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("onRenderTriggered"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" renderTriggered"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerLifecycleHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("onBeforeUnmount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" beforeUnmount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerLifecycleHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("onUnmounted"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" unmounted"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerLifecycleHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("onServerPrefetch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" serverPrefetch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ssr内容，后面不会讲")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br")])]),s("p",[t._v("这段代码还将钩子函数与"),s("code",[t._v("publicThis")]),t._v("绑定，并将它们传递给"),s("code",[t._v("registerLifecycleHook")]),t._v("函数。"),s("code",[t._v("publickThis")]),t._v("是就是当前"),s("code",[t._v("instance")]),t._v("的"),s("code",[t._v("proxy")]),t._v("对象，用于存储当前实例的变量")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("instance"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("proxy "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Proxy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("instance"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" PublicInstanceProxyHandlers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("code",[t._v("vue3")]),t._v("是在组件初始化时进行钩子函数的注册，主要经历了这些阶段：")]),t._v(" "),s("p",[s("code",[t._v("render")]),t._v("=>"),s("code",[t._v("patch")]),t._v(" => "),s("code",[t._v("processComponent")]),t._v(" => "),s("code",[t._v("mountComponent")]),t._v(" => "),s("code",[t._v("setupComponent")]),t._v(" => "),s("code",[t._v("setupStatefulComponent")]),t._v(" => "),s("code",[t._v("handleSetupResult")]),t._v("=>"),s("code",[t._v("finishComponentSetup")]),t._v(" => "),s("code",[t._v("applyOptions")]),t._v("=> "),s("code",[t._v("registerLifecycleHook")]),t._v("\n各个阶段的作用如下：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("render")]),t._v(":"),s("code",[t._v("Vue")]),t._v("组件中定义的渲染函数，它返回一个虚拟 DOM 树描述；定义了组件的 UI 结构，它可以是模板语法或者"),s("code",[t._v("render")]),t._v("函数本身，用于生成组件的虚拟 DOM。")]),t._v(" "),s("li",[s("code",[t._v("patch")]),t._v("："),s("code",[t._v("Vue")]),t._v("内部的核心函数，负责将虚拟 DOM 渲染成真实 DOM，并处理 DOM 的更新和变更；实现了 Vue 的响应式更新机制，确保虚拟 DOM 的变更能够高效地同步到真实 DOM 上，实现数据驱动的视图更新。")]),t._v(" "),s("li",[s("code",[t._v("processComponent")]),t._v("：处理组件的函数，可能包括组件的初始化、更新等过程。在组件的生命周期中，processComponent 负责管理组件的各个阶段，例如数据的准备、事件的绑定等，确保组件能够正常工作并响应数据变化。")]),t._v(" "),s("li",[s("code",[t._v("mountComponent")]),t._v("：挂载组件到 DOM 上的过程，包括创建组件实例、初始化数据等。"),s("code",[t._v("mountComponent")]),t._v(" 是组件生命周期中的重要阶段，它负责将组件实例化并将其挂载到页面的 DOM 元素上，使得组件能够被用户访问和操作。")]),t._v(" "),s("li",[s("code",[t._v("setupComponent")]),t._v("：设置组件的函数，可能包括组件的配置项、参数处理等。"),s("code",[t._v("setupComponent")]),t._v(" 阶段用于初始化组件的配置和参数，为后续的生命周期钩子、事件处理和数据绑定等操作做准备。")]),t._v(" "),s("li",[s("code",[t._v("setupStatefulComponent")]),t._v("：设置有状态组件的函数，用于处理有状态组件的状态初始化和管理。对于有状态的组件（即有响应式数据的组件），"),s("code",[t._v("setupStatefulComponent")]),t._v("负责初始化组件的状态数据，并确保这些数据的响应式更新机制能够正常运作。")]),t._v(" "),s("li",[s("code",[t._v("handleSetupResult")]),t._v("：处理设置结果的函数，可能包括对组件状态和属性的初始化。主要用于处理"),s("code",[t._v("setup()")]),t._v("函数的返回结果，确保组件的状态、计算属性等被正确地初始化和配置。")]),t._v(" "),s("li",[s("code",[t._v("finishComponentSetup")]),t._v("：完成组件设置的函数，确保组件已经初始化并准备好渲染。在组件初始化阶段的最后，"),s("code",[t._v("finishComponentSetup")]),t._v("确保所有的组件设置和初始化工作已经完成，组件可以安全地开始渲染和更新。")]),t._v(" "),s("li",[s("code",[t._v("applyOptions")]),t._v("：应用组件选项的函数，包括组件的配置项、生命周期钩子等。"),s("code",[t._v("applyOptions")]),t._v(" 用于将组件定义的选项（如 data、methods、computed 等）应用到组件实例上，以及注册和管理组件的生命周期钩子函数，确保组件在各个生命周期阶段能够执行相应的逻辑。")])]),t._v(" "),s("h5",{attrs:{id:"生命周期钩子函数的调用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生命周期钩子函数的调用"}},[t._v("#")]),t._v(" 生命周期钩子函数的调用")]),t._v(" "),s("h6",{attrs:{id:"onbeforemount"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#onbeforemount"}},[t._v("#")]),t._v(" "),s("code",[t._v("onBeforeMount")])]),t._v(" "),s("p",[t._v("在"),s("code",[t._v("mountComponent")]),t._v("阶段，会调用"),s("code",[t._v("setupRenderEffect")]),t._v("函数，这个函数顾名思义就是设置组件的"),s("code",[t._v("effect")]),t._v("，用于设置和管理组件的渲染效果，实现"),s("code",[t._v("vue3")]),t._v("组件的响应式更新机制，确保当组件的响应式数据发生变化时，能够自动重新渲染组件的视图\n"),s("code",[t._v("setupRenderEffect")]),t._v("函数内部会"),s("code",[t._v("new ReactiveEffect")]),t._v("实例，并赋值给"),s("code",[t._v("instance.effect")]),t._v("，并调用"),s("code",[t._v("componentUpdateFn")]),t._v("函数执行。而在"),s("code",[t._v("componentUpdateFn")]),t._v("中会先判断组件是否已经被挂载，如果已经挂载，则处理更新逻辑，否则进行挂载逻辑。\n当组件未被挂载时,"),s("code",[t._v("instance.isMounted")]),t._v("为"),s("code",[t._v("false")]),t._v("，"),s("code",[t._v("Vue3")]),t._v("会从"),s("code",[t._v("instance")]),t._v("中获取注册钩子函数"),s("code",[t._v("bm")]),t._v(",若它存在，在调用"),s("code",[t._v("invokeArrayFns")]),t._v("进行遍历调用。")]),t._v(" "),s("h6",{attrs:{id:"onmounted"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#onmounted"}},[t._v("#")]),t._v(" "),s("code",[t._v("onMounted")])]),t._v(" "),s("p",[s("code",[t._v("onMounted")]),t._v("钩子函数同"),s("code",[t._v("onBeforeMount")]),t._v("一样，在组件未被挂载时，从"),s("code",[t._v("instance")]),t._v("中解构注册的钩子函数"),s("code",[t._v("m")]),t._v("，通过"),s("code",[t._v("queuePostRenderEffect")]),t._v("进入调度器"),s("code",[t._v("schedule")]),t._v("，在组件挂载完成时调用"),s("code",[t._v("flushPostFlushCbs")]),t._v(",其内部会根据每一个"),s("code",[t._v("job")]),t._v("的"),s("code",[t._v("id")]),t._v("进行排序,然后依次执行。")]),t._v(" "),s("h6",{attrs:{id:"onbeforeupdate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#onbeforeupdate"}},[t._v("#")]),t._v(" "),s("code",[t._v("onBeforeUpdate")])]),t._v(" "),s("p",[s("code",[t._v("onBeforeUpdate")]),t._v("钩子函数和"),s("code",[t._v("onBeforeMount")]),t._v("函数类似，不同的是"),s("code",[t._v("onBeforeUpdate")]),t._v("是在组件被挂载后即"),s("code",[t._v("instance.isMounted")]),t._v("为"),s("code",[t._v("true")]),t._v("时，在组件发生的响应式数据变化时，解构钩子函数"),s("code",[t._v("bu")]),t._v("，被调用")]),t._v(" "),s("h6",{attrs:{id:"onupdated"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#onupdated"}},[t._v("#")]),t._v(" "),s("code",[t._v("onUpdated")])]),t._v(" "),s("p",[s("code",[t._v("onUpdated")]),t._v("钩子函数和"),s("code",[t._v("onMounted")]),t._v("函数类似，不同的是"),s("code",[t._v("onUpdated")]),t._v("是在组件被挂载后即"),s("code",[t._v("instance.isMounted")]),t._v("为"),s("code",[t._v("true")]),t._v("时，在组件发生的响应式数据变化时，解构钩子函数"),s("code",[t._v("u")]),t._v("，被调用")]),t._v(" "),s("h6",{attrs:{id:"onbeforeunmount"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#onbeforeunmount"}},[t._v("#")]),t._v(" "),s("code",[t._v("onBeforeUnmount")])]),t._v(" "),s("p",[s("code",[t._v("onBeforeUnmount")]),t._v("在组件卸载前会调用,对应的注册的钩子函数变量名为"),s("code",[t._v("bum")]),t._v(",会在"),s("code",[t._v("unmountComponent")]),t._v("函数里调用。而"),s("code",[t._v("unmountComponent")]),t._v("函数会在函数"),s("code",[t._v("unmount")]),t._v("中判断"),s("code",[t._v("shapeFlag")]),t._v(",若其为组件类型则调用。通过"),s("code",[t._v("invokeArrayFns")]),t._v("进行遍历执行")]),t._v(" "),s("h6",{attrs:{id:"onunmounted"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#onunmounted"}},[t._v("#")]),t._v(" "),s("code",[t._v("onUnmounted")])]),t._v(" "),s("p",[s("code",[t._v("onUnmounted")]),t._v("在组件卸载后调用,对应的注册的钩子函数变量名为"),s("code",[t._v("um")]),t._v(",组件在卸载时先调用"),s("code",[t._v("onBeforeUnmount")]),t._v("钩子，如果"),s("code",[t._v("instance.update")]),t._v("存在，则调用"),s("code",[t._v("unmount")]),t._v("方法，然后调用"),s("code",[t._v("queuePostRenderEffect")]),t._v("将"),s("code",[t._v("um")]),t._v("加入到调度器中，在组件卸载完成后调用"),s("code",[t._v("flushPostFlushCbs")]),t._v("，执行"),s("code",[t._v("um")]),t._v("钩子函数。")])])}),[],!1,null,null,null);s.default=e.exports}}]);