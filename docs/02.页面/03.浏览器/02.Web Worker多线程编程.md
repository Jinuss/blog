---
title: Web Workerå¤šçº¿ç¨‹ç¼–ç¨‹
date: 2024-05-17 16:10:10
permalink: /pages/847s81edhsbi
categories:
  - HTML
  - æµè§ˆå™¨
  - é€šä¿¡
tags:
  - null
author:
  name: ä¸œæµ
  link: https://github.com/Jinuss
---

### Web Worker è§£å†³äº†ä»€ä¹ˆé—®é¢˜

æµè§ˆå™¨ Javascript æ˜¯ä»¥å•çº¿ç¨‹æ–¹å¼è¿è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯æ„å‘³ç€ JS æ‰§è¡Œå’Œ UI æ¸²æŸ“å ç”¨åŒä¸€ä¸ªä¸»çº¿ç¨‹ï¼Œå½“ Javascript è¿›è¡Œé«˜è´Ÿè½½çš„æ•°æ®å¤„ç†æˆ–è¿ç®—æ—¶ï¼ŒUI æ¸²æŸ“å°±å¾ˆæœ‰å¯èƒ½è¢«é˜»æ–­ï¼Œæµè§ˆå™¨å°±ä¼šå‡ºçŽ°å¡é¡¿ï¼Œè¿™æ ·å¾ˆå®¹æ˜“é™ä½Žç”¨æˆ·ä½“éªŒã€‚

ä¸ºæ­¤ï¼ŒJavascrip æä¾›äº†å¼‚æ­¥æ“ä½œ,å¦‚å®šæ—¶å™¨ã€ajaxã€I/O å›žè°ƒç­‰ï¼Œä½†è¿™äº›å¼‚æ­¥ä»£ç éƒ½æ˜¯è¿è¡Œåœ¨ä¸»çº¿ç¨‹ä¸Šçš„ï¼Œå¦‚æžœä¸»çº¿ç¨‹è¢«é˜»å¡žï¼Œé‚£ä¹ˆå¼‚æ­¥ä»£ç ä¹Ÿå°±æ— æ³•æ‰§è¡Œï¼Œä¸èƒ½ä»Žæ ¹æœ¬ä¸Šè§£å†³é—®é¢˜ã€‚æ‰€ä»¥å¤šçº¿ç¨‹`Web worker`åº”è¿è€Œç”Ÿï¼Œå®ƒæ˜¯ HTML5 æ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼Œå…è®¸åˆ›å»ºä¸€ä¸ªæ–°çš„å­çº¿ç¨‹ï¼Œå­çº¿ç¨‹å’Œä¸»çº¿ç¨‹å¯ä»¥åŒæ—¶å…è®¸ï¼Œä¸”äº’ä¸å¹²æ‰°ã€‚

æ­¤å¤– worker å’Œä¸»çº¿ç¨‹ä¹‹é—´å¯ä»¥é€šè¿‡`postMessage`å’Œ`onmessage`æ–¹æ³•è¿›è¡ŒåŒå‘æ•°æ®é€šä¿¡

### Web Worker å¦‚ä½•ä½¿ç”¨

ç¤ºä¾‹å¦‚ä¸‹

```js
/*main.js*/
const worker = new Worker("./js/worker.js");
console.log("ðŸš€ ~ worker:", worker);
worker.postMessage("hello");
worker.onmessage = ({ data }) => {
  console.log("ðŸš€", data);
  for (let i = 0; i < 100; i++) {
    console.log("main:", i);
  }
  // worker.terminate()
};
```

```js
/*worker.js*/
addEventListener("message", ({ data }) => {
  console.log(data);
  postMessage("hi");
  for (let i = 0; i < 100; i++) {
    console.log("worker:", i);
  }
});
```

### Web Worker éœ€è¦æ³¨æ„çš„é—®é¢˜

#### è®¿é—®é™åˆ¶

woorker å­çº¿ç¨‹æ‰€åœ¨çš„å…¨å±€å¯¹è±¡ï¼Œä¸Žä¸»çº¿ç¨‹ä¸åœ¨åŒä¸€ä¸ªä¸Šä¸‹æ–‡çŽ¯å¢ƒï¼Œæ‰€ä»¥æ— æ³•è®¿é—®åˆ°ä¸»çº¿ç¨‹çš„ window å¯¹è±¡ï¼ŒåŒ…æ‹¬ document å¯¹è±¡ï¼Œdocument å¯¹è±¡æ— æ³•è¢«è®¿é—®åˆ°ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ postMessage æ¥ä¼ é€’æ•°æ®ã€‚

#### è·¨åŸŸé™åˆ¶

worker è„šæœ¬æ–‡ä»¶å¿…é¡»ä¸Žä¸»çº¿ç¨‹è„šæœ¬åŒæºï¼Œè¿™ä¸ªå¯ä»¥å°† worker è„šæœ¬æ–‡ä»¶è½¬æ¢æˆ Blob å¯¹è±¡ï¼Œåœ¨ç”Ÿæˆ URLï¼Œä¼ ç»™ Worker çš„æž„é€ å‡½æ•°

### åº”ç”¨åœºæ™¯

- ä½¿ç”¨ä¸“ç”¨çº¿ç¨‹è¿›è¡Œæ•°å­¦è¿ç®—ï¼Œæ¯”å¦‚å¤„ç†å¤§æ‰¹é‡æ•°æ®ã€è¯»å–ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ã€æ›´æ”¹ canvas ä½å›¾ç­‰
- é«˜é¢‘ç”¨æˆ·äº¤äº’
- æ•°æ®çš„é¢„å–
