---
title: JSä¸­å¯è¿­ä»£çš„æ•°æ®ç±»å‹
date: 2025-08-06 17:37:38
permalink: /pages/d630e1/
categories:
  - å‰ç«¯
  - JavaScriptæ–‡ç« 
tags:
  - 
author: 
  name: ä¸œæµ
  link: https://github.com/Jinuss
---

# JavaScript å¯è¿­ä»£æ•°æ®ç±»å‹è¯¦è§£ï¼šæŒæ¡ for...of çš„å¥¥ç§˜

åœ¨ JavaScript ä¸­ï¼Œå¯è¿­ä»£å¯¹è±¡æ˜¯æŒ‡å®ç°äº† **å¯è¿­ä»£åè®®** çš„å¯¹è±¡ï¼Œå®ƒä»¬å¯ä»¥ä½¿ç”¨ `for...of` å¾ªç¯è¿›è¡Œéå†ã€‚ç†è§£å“ªäº›æ•°æ®ç±»å‹æ˜¯å¯è¿­ä»£çš„ï¼Œå¯¹äºç¼–å†™é«˜æ•ˆã€ç°ä»£çš„ JavaScript ä»£ç è‡³å…³é‡è¦ã€‚

## ä»€ä¹ˆæ˜¯å¯è¿­ä»£å¯¹è±¡ï¼Ÿ

å¯è¿­ä»£å¯¹è±¡å¿…é¡»å®ç° `Symbol.iterator` æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ã€‚è¿­ä»£å™¨å¯¹è±¡æœ‰ä¸€ä¸ª `next()` æ–¹æ³•ï¼Œæ¯æ¬¡è°ƒç”¨è¿”å›ä¸€ä¸ªåŒ…å« `value` å’Œ `done` å±æ€§çš„å¯¹è±¡ã€‚

```javascript
const iterable = {
   {
    let step = 0;
    return {
      next() {
        step++;
        if (step <= 3) {
          return { value: step, done: false };
        }
        return { value: undefined, done: true };
      }
    };
  }
};

for (const value of iterable) {
  console.log(value); // 1, 2, 3
}
```

## JavaScript å†…ç½®çš„å¯è¿­ä»£æ•°æ®ç±»å‹

### 1. Arrayï¼ˆæ•°ç»„ï¼‰âœ…
æ•°ç»„æ˜¯æœ€å¸¸è§çš„å¯è¿­ä»£å¯¹è±¡ï¼š
```javascript
const fruits = ['ğŸ', 'ğŸŒ', 'ğŸŠ'];
for (const fruit of fruits) {
  console.log(fruit); // ğŸ, ğŸŒ, ğŸŠ
}
```

### 2. Stringï¼ˆå­—ç¬¦ä¸²ï¼‰âœ…
å­—ç¬¦ä¸²ä¹Ÿæ˜¯å¯è¿­ä»£çš„ï¼Œä¼šé€ä¸ªè¿”å›å­—ç¬¦ï¼š
```javascript
const greeting = 'Hello';
for (const char of greeting) {
  console.log(char); // H, e, l, l, o
}
```

### 3. Map âœ…
Map å¯¹è±¡åœ¨è¿­ä»£æ—¶ä¼šè¿”å› `[key, value]` å¯¹ï¼š
```javascript
const userMap = new Map([
  ['name', 'Alice'],
  ['age', 30]
]);

for (const [key, value] of userMap) {
  console.log(`${key}: ${value}`);
}
// è¾“å‡º:
// name: Alice
// age: 30
```

### 4. Set âœ…
Set å¯¹è±¡è¿­ä»£æ—¶è¿”å›é›†åˆä¸­çš„æ¯ä¸ªå€¼ï¼š
```javascript
const uniqueNumbers = new Set([1, 2, 2, 3]);
for (const num of uniqueNumbers) {
  console.log(num); // 1, 2, 3
}
```

### 5. TypedArrayï¼ˆç±»å‹åŒ–æ•°ç»„ï¼‰âœ…
å¦‚ Int8Array, Uint8Array ç­‰ï¼š
```javascript
const intArray = new Int8Array([10, 20, 30]);
for (const num of intArray) {
  console.log(num); // 10, 20, 30
}
```

### 6. Arguments å¯¹è±¡ âœ…
å‡½æ•°å†…éƒ¨çš„ arguments å¯¹è±¡æ˜¯å¯è¿­ä»£çš„ï¼š
```javascript
function sum() {
  let total = 0;
  for (const arg of arguments) {
    total += arg;
  }
  return total;
}

console.log(sum(1, 2, 3)); // 6
```

### 7. DOM é›†åˆ âœ…
è®¸å¤š DOM é›†åˆæ˜¯å¯è¿­ä»£çš„ï¼š
```javascript
// è·å–æ‰€æœ‰ div å…ƒç´ 
const divs = document.querySelectorAll('div');

// ä½¿ç”¨ for...of éå†
for (const div of divs) {
  console.log(div);
}
```

### 8. Generator å¯¹è±¡ âœ…
ç”Ÿæˆå™¨å‡½æ•°è¿”å›çš„å¯¹è±¡æ˜¯å¯è¿­ä»£çš„ï¼š
```javascript
function* generateSequence() {
  yield 1;
  yield 2;
  yield 3;
}

for (const value of generateSequence()) {
  console.log(value); // 1, 2, 3
}
```

## ä¸å¯è¿­ä»£çš„æ•°æ®ç±»å‹

### 1. Objectï¼ˆæ™®é€šå¯¹è±¡ï¼‰âŒ
æ™®é€šå¯¹è±¡é»˜è®¤ä¸å¯è¿­ä»£ï¼š
```javascript
const person = { name: 'Alice', age: 30 };

// ä¼šæŠ¥é”™: person is not iterable
for (const key of person) {
  console.log(key);
}
```

### 2. WeakMap å’Œ WeakSet âŒ
è¿™äº›å¼±å¼•ç”¨é›†åˆä¸å¯è¿­ä»£ï¼š
```javascript
const weakMap = new WeakMap();
weakMap.set({}, 'value');

// æŠ¥é”™: weakMap is not iterable
for (const entry of weakMap) {
  console.log(entry);
}
```

## å¦‚ä½•ä½¿æ™®é€šå¯¹è±¡å¯è¿­ä»£

è™½ç„¶æ™®é€šå¯¹è±¡é»˜è®¤ä¸å¯è¿­ä»£ï¼Œä½†æˆ‘ä»¬å¯ä»¥ä½¿å…¶å¯è¿­ä»£ï¼š

```javascript
const person = {
  name: 'Alice',
  age: 30,
  job: 'Developer',
   {
    const keys = Object.keys(this);
    let index = 0;
    
    return {
      next: () => {
        if (index < keys.length) {
          const key = keys[index++];
          return { value: [key, this[key]], done: false };
        }
        return { done: true };
      }
    };
  }
};

for (const [key, value] of person) {
  console.log(`${key}: ${value}`);
}
// è¾“å‡º:
// name: Alice
// age: 30
// job: Developer
```

## for...of ä¸ for...in çš„åŒºåˆ«

| ç‰¹æ€§ | for...of | for...in |
|------|----------|----------|
| ç”¨é€” | éå†å¯è¿­ä»£å¯¹è±¡çš„å€¼ | éå†å¯¹è±¡çš„å¯æšä¸¾å±æ€§ |
| è¿”å›å€¼ | å€¼ | é”®/å±æ€§å |
| åŸå‹é“¾ | ä¸éå†åŸå‹é“¾ | éå†åŸå‹é“¾ä¸Šçš„å¯æšä¸¾å±æ€§ |
| é€‚ç”¨å¯¹è±¡ | å¯è¿­ä»£å¯¹è±¡ | æ‰€æœ‰å¯¹è±¡ |
| æ•°ç»„éå† | å€¼ | ç´¢å¼• |
| é¡ºåº | ä¿æŒæ’å…¥é¡ºåº | ä¸ä¿è¯é¡ºåºï¼ˆè™½ç„¶é€šå¸¸æŒ‰æ’å…¥é¡ºåºï¼‰ |

## å®é™…åº”ç”¨åœºæ™¯

### 1. éå† Map çš„é”®å€¼å¯¹
```javascript
const settings = new Map([
  ['theme', 'dark'],
  ['fontSize', 16],
  ['notifications', true]
]);

for (const [key, value] of settings) {
  console.log(`Setting ${key} is set to ${value}`);
}
```

### 2. å¤„ç†å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦
```javascript
function countVowels(str) {
  const vowels = 'aeiouAEIOU';
  let count = 0;
  
  for (const char of str) {
    if (vowels.includes(char)) count++;
  }
  
  return count;
}

console.log(countVowels('Hello World')); // 3
```

### 3. è‡ªå®šä¹‰æ•°æ®ç»“æ„çš„è¿­ä»£
```javascript
class Range {
  constructor(start, end) {
    this.start = start;
    this.end = end;
  }
  
  * {
    for (let i = this.start; i <= this.end; i++) {
      yield i;
    }
  }
}

const range = new Range(1, 5);
for (const num of range) {
  console.log(num); // 1, 2, 3, 4, 5
}
```

### 4. å¼‚æ­¥è¿­ä»£
ES2018 å¼•å…¥äº†å¼‚æ­¥è¿­ä»£å™¨ï¼Œå¯ä»¥ä¸ `for await...of` ä¸€èµ·ä½¿ç”¨ï¼š
```javascript
async function fetchUrls(urls) {
  for await (const response of fetchMultiple(urls)) {
    console.log(await response.text());
  }
}

async function* fetchMultiple(urls) {
  for (const url of urls) {
    yield fetch(url);
  }
}
```

## å¸¸è§é—®é¢˜è§£ç­”

### Q: å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å¯è¿­ä»£ï¼Ÿ
```javascript
function isIterable(obj) {
  return obj != null && typeof obj[Symbol.iterator] === 'function';
}

console.log(isIterable([])); // true
console.log(isIterable({})); // false
```

### Q: ä¸ºä»€ä¹ˆæ™®é€šå¯¹è±¡ä¸å¯è¿­ä»£ï¼Ÿ
- å†å²åŸå› ï¼šES6 ä¹‹å‰æ²¡æœ‰è¿­ä»£åè®®
- è®¾è®¡é€‰æ‹©ï¼šå¯¹è±¡å±æ€§çš„è¿­ä»£é¡ºåºä¸ç¡®å®š
- æ›¿ä»£æ–¹æ¡ˆï¼šä½¿ç”¨ `Object.keys()`, `Object.values()`, `Object.entries()`

### Q: å¦‚ä½•éå†å¯¹è±¡çš„é”®å€¼å¯¹ï¼Ÿ
```javascript
const person = { name: 'Alice', age: 30 };

// ä½¿ç”¨ Object.entries è½¬æ¢ä¸ºå¯è¿­ä»£çš„é”®å€¼å¯¹æ•°ç»„
for (const [key, value] of Object.entries(person)) {
  console.log(`${key}: ${value}`);
}
```

### Q: for...of å¯ä»¥ç”¨äº NodeList å—ï¼Ÿ
æ˜¯çš„ï¼Œ`NodeList` æ˜¯å¯è¿­ä»£çš„ï¼š
```javascript
const buttons = document.querySelectorAll('button');
for (const button of buttons) {
  button.addEventListener('click', handleClick);
}
```

## æ€»ç»“

JavaScript ä¸­å¯è¿­ä»£çš„æ•°æ®ç±»å‹åŒ…æ‹¬ï¼š
- `Array`
- `String`
- `Map`
- `Set`
- `TypedArray`
- `Arguments` å¯¹è±¡
- `DOM` é›†åˆ
- `Generator` å¯¹è±¡

ä¸å¯è¿­ä»£çš„æ•°æ®ç±»å‹åŒ…æ‹¬ï¼š
- æ™®é€š `Object`
- `WeakMap`
- `WeakSet`

æŒæ¡è¿™äº›å¯è¿­ä»£ç±»å‹åŠå…¶ä½¿ç”¨åœºæ™¯ï¼Œå¯ä»¥è®©ä½ ï¼š
1. ç¼–å†™æ›´ç®€æ´ã€æ›´ç°ä»£çš„ä»£ç 
2. æ›´å¥½åœ°å¤„ç†é›†åˆæ•°æ®
3. åˆ›å»ºè‡ªå®šä¹‰çš„å¯è¿­ä»£æ•°æ®ç»“æ„
4. åˆ©ç”¨è¿­ä»£åè®®å®ç°æ›´é«˜çº§çš„åŠŸèƒ½

`for...of` å¾ªç¯æ˜¯å¤„ç†å¯è¿­ä»£å¯¹è±¡çš„å¼ºå¤§å·¥å…·ï¼Œå®ƒæä¾›äº†æ¯”ä¼ ç»Ÿ `for` å¾ªç¯æ›´ç®€æ´ã€æ›´å®‰å…¨çš„è¯­æ³•ï¼ŒåŒæ—¶é¿å…äº† `for...in` å¾ªç¯çš„ä¸€äº›é™·é˜±ã€‚