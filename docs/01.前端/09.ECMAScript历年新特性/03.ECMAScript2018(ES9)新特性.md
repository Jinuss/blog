---
title: ECMAScript2018(ES9)æ–°ç‰¹æ€§
date: 2025-07-30 11:33:57
permalink: /pages/962139/
categories:
  - å‰ç«¯
  - ECMAScriptå†å¹´æ–°ç‰¹æ€§
tags:
  - 
author: 
  name: ä¸œæµ
  link: https://github.com/Jinuss
---

## æ¦‚è¿°

*ECMAScript2018* äº2018å¹´6æœˆæ­£å¼å‘å¸ƒï¼Œ æœ¬æ–‡ä¼šä»‹ç»*ECMAScript2018(ES9)*ï¼Œå³ECMAScriptçš„ç¬¬9ä¸ªç‰ˆæœ¬çš„æ–°ç‰¹æ€§ã€‚

ä»¥ä¸‹æ‘˜è‡ªå®˜ç½‘ï¼š[ecma-262](https://tc39.es/ecma262/multipage/#sec-intro)

> ECMAScript 2018 introduced support for asynchronous iteration via the async iterator protocol and async generators. It also included four new regular expression features: the dotAll flag, named capture groups, Unicode property escapes, and look-behind assertions. Lastly it included object rest and spread properties.

## **ECMAScript2018(ES9)**

**ES9**èšç„¦äºå¼‚æ­¥ç¼–ç¨‹ã€æ­£åˆ™è¡¨è¾¾å¼å’Œå¯¹è±¡æ“ä½œçš„æ ‡å‡†åŒ–ã€‚æ–°å¢çš„ç‰¹æ€§å¦‚ä¸‹ï¼š

- å¼‚æ­¥è¿­ä»£ `Async Iteration`
- `Reset/Spread`æ“ä½œç¬¦å’Œå¯¹è±¡æ„å»º
- æ­£åˆ™è¡¨è¾¾å¼`RegExp`å¢å¼º
- `promise.finally`
- æ¨¡ç‰ˆå­—ç¬¦ä¸²æ”¹è¿›
- å…¶å®ƒæ”¹è¿›

### å¼‚æ­¥è¿­ä»£ï¼ˆ`Async Iteration`ï¼‰

é€šè¿‡`async/await`ä¸è¿­ä»£å™¨çš„é›†åˆï¼Œæ”¯æŒå¼‚æ­¥å¾ªç¯æ“ä½œ
- å¼‚æ­¥è¿­ä»£å™¨åè®®ï¼š`Symbol.asyncIterator`å…è®¸å¯¹è±¡å®šä¹‰å¼‚æ­¥è¿­ä»£è¡Œä¸º
- `for await ...of`å¾ªç¯ï¼šç”¨äºéå†å¼‚æ­¥å¯è¿­ä»£å¯¹è±¡ï¼ˆå¦‚å¼‚æ­¥ç”Ÿæˆå™¨ï¼‰

#### ç¤ºä¾‹
```js
async function* fetchPosts() {
  const urls = ['/api/post1', '/api/post2'];
  for (const url of urls) {
    yield await fetch(url).then(res => res.json());
  }
}

// ä½¿ç”¨ for await...of éå†
(async () => {
  for await (const post of fetchPosts()) {
    console.log(post.title);
  }
})();
```
#### å…¼å®¹æ€§

<img src="https://cdn.jsdelivr.net/gh/Jinuss/image-host/blog//es9/asyncIterator.png"/>

### å¯¹è±¡å±•å¼€ä¸å‰©ä½™å±æ€§(`Object Rest /Spread Properties`)

- **å±•å¼€è¯­æ³•**ï¼šç”¨äºå¤åˆ¶å¯¹è±¡çš„æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼ˆæµ…æ‹·è´ï¼‰

```js
const obj = { a: 1, b: 2 };
const newObj = { ...obj, c: 3 }; // { a: 1, b: 2, c: 3 }
```

- **å‰©ä½™å±æ€§**:ç”¨äºæ”¶é›†å¯¹è±¡ä¸­æœªè¢«è§£æ„çš„å±æ€§

```js
const { a, ...rest } = { a: 1, b: 2, c: 3 };
console.log(rest); // { b: 2, c: 3 }
```

#### å…¼å®¹æ€§
<img src="https://cdn.jsdelivr.net/gh/Jinuss/image-host/blog//es9/ObjectRest.png"/>
<img src="https://cdn.jsdelivr.net/gh/Jinuss/image-host/blog//es9/SpreadProperties.png"/>

### æ­£åˆ™è¡¨è¾¾å¼å¢å¼º

- **dotAllæ ‡å¿—**ï¼šä½¿æ­£åˆ™è¡¨è¾¾å¼çš„ç‚¹å·`.`å¯ä»¥åŒ¹é…åŒ…æ‹¬æ¢è¡Œç¬¦`\n`åœ¨å†…çš„æ‰€æœ‰å­—ç¬¦

```js
const str = 'Hello\nWorld';
/Hello.World/s.test(str); // trueï¼ˆæœªåŠ  s æ ‡å¿—æ—¶ä¸º falseï¼‰
```

- **å‘½åæ•è·ç»„ï¼ˆName Capture Groupsï¼‰**ï¼šé€šè¿‡`(?<name>pattern)`è¯­æ³•ä¸ºæ•è·ç»„å‘½åï¼Œä¾¿äºå¼•ç”¨

```js
const re = /(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/;
const { groups: { year, month, day } } = re.exec('2023-01-01');
console.log(year, month, day); // 2023 01 01
```

- **Unicodeå±æ€§è½¬ä¹‰ï¼ˆUnicode Property Escapesï¼‰**ï¼šé€šè¿‡`\p{...}`è¯­æ³•åŒ¹é…`Unicode`å­—ç¬¦å±æ€§

```js
// åŒ¹é…æ‰€æœ‰ emoji
const emoji = 'ğŸ‘‹ Hello ğŸ˜Š';
emoji.match(/\p{Emoji}/gu); // ['ğŸ‘‹', 'ğŸ˜Š']
```

- **åè¡Œæ–­è¨€ï¼ˆLook-behind Assertionsï¼‰**ï¼šé€šè¿‡`(?<=pattern)`è¯­æ³•æ”¯æŒå‘å‰æˆ–å‘åæ–­è¨€åŒ¹é…

```js
// åŒ¹é…ç¾å…ƒç¬¦å·åçš„æ•°å­—ï¼ˆåè¡Œæ–­è¨€ï¼‰
/(?<=\$)\d+/.exec('Price: $99'); // ['99']

// åŒ¹é…æ•°å­—å‰çš„ç¾å…ƒç¬¦å·ï¼ˆå…ˆè¡Œæ–­è¨€ï¼‰
/\$\d+(?= tax)/.exec('$99 tax'); // ['$99']
```

#### å…¼å®¹æ€§

<img src="https://cdn.jsdelivr.net/gh/Jinuss/image-host/blog//es9/dotaAll.png"/>
<img src="https://cdn.jsdelivr.net/gh/Jinuss/image-host/blog//es9/NameCaptureGroups.png"/>
<img src="https://cdn.jsdelivr.net/gh/Jinuss/image-host/blog//es9/unicode.png"/>
<img src="https://cdn.jsdelivr.net/gh/Jinuss/image-host/blog//es9/lookbehind.png"/>

### `promise.finally`

- **`promise.finally`**ï¼šæ— è®º`Promise`å¯¹è±¡çš„çŠ¶æ€å¦‚ä½•ï¼Œéƒ½ä¼šæ‰§è¡Œ`finally`æŒ‡å®šçš„å›è°ƒå‡½æ•°

```js
new Promise((resolve, reject) => {
  resolve();
}).finally(() => {
  console.log('finally');
});
```

#### å…¼å®¹æ€§

<img src="https://cdn.jsdelivr.net/gh/Jinuss/image-host/blog//es9/Promise.prototype.finally.png"/>

### æ¨¡ç‰ˆå­—ç¬¦ä¸²æ”¹è¿›

æœªå¼•å…¥æ–°è¯­æ³•ï¼Œä½†æ˜¯è§„èŒƒäº†æ¨¡ç‰ˆå­—ç¬¦ä¸²çš„è½¬ä¹‰å¤„ç†ï¼Œå¦‚`\u`å’Œ`\x`

```js
// é¿å…æ„å¤–è½¬ä¹‰é”™è¯¯
const str = String.raw`\u{1F600}`; // ç›´æ¥è¾“å‡º "\u{1F600}" è€Œé Unicode å­—ç¬¦
```

### å…¶ä»–æ”¹è¿›

- **`JSON.string`å¢å¼º**ï¼šæ”¯æŒå¤„ç†è¶…å‡ºèŒƒå›´çš„`Unicode`å­—ç¬¦

```js
JSON.stringify('ğŸ˜€'); // æ­£ç¡®è¾“å‡º "\ud83d\ude00"
```

- **å‡½æ•°å‚æ•°åˆ—è¡¨å’Œè°ƒç”¨ä¸­çš„å°¾é€—å·**:å…è®¸åœ¨å‡½æ•°å‚æ•°å’Œè°ƒç”¨ä¸­ä½¿ç”¨å°¾é€—å·ï¼Œæå‡ä»£ç ç»´æŠ¤æ€§
```js
function sum(a, b,) { // åˆæ³•
  return a + b;
}
```