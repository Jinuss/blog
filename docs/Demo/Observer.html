<!DOCTYPE html>
<html>
<title>MutationObserver</title>

<head>
    <title>MutationObserver</title>
</head>
<style>
    html,
    body {
        margin: 0 auto;
        padding: 0;
        height: 100%;
    }

    .Panel {
        height: 100%;
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .container {
        margin: 50px;
        height: calc(100% - 100px);
        width: calc(100% - 100px);
        border: 1px solid red;
        display: flex;
        flex-wrap: wrap;
    }

    .container>div {
        width: calc(50% - 22px);
        height: calc(50% - 22px);
        padding: 10px;
    }

    .container>div:nth-child(1) {
        border-right: 1px solid red;
        border-bottom: 1px solid red;
    }

    .container>div:nth-child(4) {
        border-left: 1px solid red;
        border-top: 1px solid red;
        margin-top: -2px;
    }

    #div1 {
        width: 200px;
        height: fit-content;
        margin: 0 auto;
        background-color: orange;
    }

    #imgList {
        display: flex;
        /* flex-direction: column; */
        flex-wrap: wrap;
        overflow: auto;
        height: calc(100% - 40px);
        justify-content: center;
    }

    #imgList img {
        width: 202px;
        height: 66px;
        /* width: calc(50% - 20px); */
        padding: 10px;
    }
</style>

<body>
    <div class="Panel">
        <div class="container">
            <div>
                <p>å˜åŠ¨è§‚å¯Ÿå™¨ MutationObserver</p>
                <div id="div1" ondrag="drag(event)" draggable="true">Hello</div>
                <button onclick="add()">add</button>
            </div>
            <div>
                <p>è°ƒæ•´è§‚å¯Ÿå™¨ ResizeObserver</p>
            </div>
            <div>
                <p>äº¤å‰è§‚å¯Ÿå™¨ IntersectionObserver</p>
                <div id="imgList">
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                </div>
            </div>
            <div>
                <p>æ€§èƒ½è§‚å¯Ÿå™¨ PerformanceObserver</p>
            </div>
        </div>
    </div>
    <script>
        var callback = function (mutations, observer) { console.log("ğŸš€ ~ mutations, observer:", mutations, observer) };


        var config = { attributes: true, childList: true, characterData: true };

        // åˆ›å»ºä¸€ä¸ªè§‚å¯Ÿè€…å®ä¾‹å¹¶ä¼ å…¥å›è°ƒå‡½æ•°
        var observer = new MutationObserver(callback);
        function drag(ev) {
            // console.log("ğŸš€ ~ drag ~ ev:", ev)
            ev.dataTransfer.setData("text", ev.target.id);
        }

        observer.observe(document.getElementById("div1"), config);

        function add() {
            // åˆ›å»ºä¸€ä¸ª <span> å…ƒç´ 
            var spanElement = document.createElement("p");

            // å¯é€‰ï¼šæ·»åŠ æ–‡æœ¬å†…å®¹
            spanElement.textContent = "è¿™æ˜¯ä¸€ä¸ª p å…ƒç´ ";

            // æ‰¾åˆ°è¦æ·»åŠ  <span> å…ƒç´ çš„çˆ¶å…ƒç´ ï¼Œå‡è®¾çˆ¶å…ƒç´ çš„ id ä¸º "container"
            var parentElement = document.getElementById("div1");

            // å°† <span> å…ƒç´ æ·»åŠ åˆ°çˆ¶å…ƒç´ ä¸­
            parentElement.appendChild(spanElement);
        }

        var resizeObserver = new ResizeObserver(function (entries) {
            console.log(entries);
        });
        resizeObserver.observe(document.getElementById("div1"));

        // äº¤å‰è§‚å¯Ÿå™¨
        var intersectionObserver = new IntersectionObserver(function (entries, intersectionobserver) {
            entries.forEach(function (entry) {
                if (entry.isIntersecting) {
                    entry.target.src = entry.target.dataset.src;
                    // intersectionobserver.unobserve(entry.target);
                }
            });
        }, { threshold: 0.5 });
        var aImgs = document.getElementsByTagName("img")
        for (var i = 0; i < aImgs.length; i++) {
            intersectionObserver.observe(aImgs[i]);
        }

        //æ€§èƒ½è§‚å¯Ÿå™¨
        if (window.PerformanceObserver) {
            var po = new PerformanceObserver(function (list) {
                var entries = list.getEntries();
                console.log(entries);
            });

            po.observe({ entryTypes: ['resource', 'paint'], buffered: true });
        }
    </script>
</body>

</html>